<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Quran Ruku Viewer</title>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        display: flex;
        height: 100vh;
    }

    /* Левая панель */
    #sidebar {
        width: 300px;
        border-right: 1px solid #ddd;
        padding: 10px;
        overflow-y: auto;
        box-sizing: border-box;
    }

    .ruku {
        padding: 10px;
        margin-bottom: 8px;
        border: 1px solid #ccc;
        border-radius: 6px;
        cursor: pointer;
    }

    .ruku:hover {
        background: #f5f5f5;
    }

    .tags {
        font-size: 12px;
        color: #666;
    }

    /* Правая часть */
    #content {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        box-sizing: border-box;
    }

    .ayah {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 15px;
        border-bottom: 1px dashed #ddd;
        padding-bottom: 10px;
    }

    .translation {
        font-size: 16px;
    }

    .arabic {
        font-size: 22px;
        text-align: right;
        direction: rtl;
        font-family: "Amiri", serif;
    }

    select {
        width: 100%;
        margin-bottom: 10px;
        padding: 5px;
    }
</style>
</head>
<body>

<div id="sidebar">
    <select id="tagFilter">
        <option value="">Все теги</option>
    </select>

    <div id="rukuList"></div>
</div>

<div id="content">
    <h2>Выберите руку‘</h2>
</div>

<script>
const rukuData = [
    {
        id: 1,
        title: "Руку‘ 1 — Аль-Бакара",
        tags: ["вера", "таухид"],
        ayahs: [1,2,3,4,5]
    },
    {
        id: 2,
        title: "Руку‘ 2 — Аль-Бакара",
        tags: ["закон", "шариат"],
        ayahs: [21,22,23,24,25]
    }
];

const rukuList = document.getElementById("rukuList");
const tagFilter = document.getElementById("tagFilter");
const content = document.getElementById("content");

/* Заполняем теги */
const tags = [...new Set(rukuData.flatMap(r => r.tags))];
tags.forEach(tag => {
    const opt = document.createElement("option");
    opt.value = tag;
    opt.textContent = tag;
    tagFilter.appendChild(opt);
});

/* Рендер списка руку‘ */
function renderRukuList(filterTag = "") {
    rukuList.innerHTML = "";
    rukuData
        .filter(r => !filterTag || r.tags.includes(filterTag))
        .forEach(ruku => {
            const div = document.createElement("div");
            div.className = "ruku";
            div.innerHTML = `
                <strong>${ruku.title}</strong>
                <div class="tags">#${ruku.tags.join(" #")}</div>
            `;
            div.onclick = () => loadRuku(ruku);
            rukuList.appendChild(div);
        });
}

tagFilter.onchange = () => renderRukuList(tagFilter.value);

/* Загрузка текста руку‘ */
async function loadRuku(ruku) {
    content.innerHTML = `<h2>${ruku.title}</h2>`;

    const ayahIds = ruku.ayahs.join(",");

    const response = await fetch(
        `https://api.quran.com/api/v4/verses/by_key/2:${ayahIds}?translations=20`
    );
    const data = await response.json();

    data.verses.forEach(v => {
        const ayahDiv = document.createElement("div");
        ayahDiv.className = "ayah";

        ayahDiv.innerHTML = `
            <div class="translation">${v.translations[0].text}</div>
            <div class="arabic">${v.text_uthmani}</div>
        `;

        content.appendChild(ayahDiv);
    });
}

renderRukuList();
</script>

</body>
</html>
